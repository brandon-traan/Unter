{"filter":false,"title":"sessions_helper.rb","tooltip":"/app/helpers/sessions_helper.rb","undoManager":{"mark":8,"position":8,"stack":[[{"start":{"row":3,"column":31},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":112},{"start":{"row":4,"column":0},"end":{"row":4,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":4,"column":4},"end":{"row":4,"column":35},"action":"insert","lines":["session[:user_role] = user.role"],"id":113}],[{"start":{"row":18,"column":28},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":114},{"start":{"row":19,"column":0},"end":{"row":19,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":19,"column":4},"end":{"row":19,"column":30},"action":"insert","lines":["session.delete(:user_role)"],"id":115}],[{"start":{"row":19,"column":30},"end":{"row":19,"column":32},"action":"insert","lines":["  "],"id":116}],[{"start":{"row":19,"column":32},"end":{"row":19,"column":34},"action":"insert","lines":["  "],"id":117}],[{"start":{"row":21,"column":5},"end":{"row":22,"column":0},"action":"insert","lines":["",""],"id":118},{"start":{"row":22,"column":0},"end":{"row":22,"column":2},"action":"insert","lines":["  "]},{"start":{"row":22,"column":2},"end":{"row":23,"column":0},"action":"insert","lines":["",""]},{"start":{"row":23,"column":0},"end":{"row":23,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":23,"column":2},"end":{"row":24,"column":0},"action":"insert","lines":["",""],"id":122},{"start":{"row":24,"column":0},"end":{"row":24,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":23,"column":2},"end":{"row":63,"column":5},"action":"insert","lines":["def current_user?(user)","      user == current_user","  end","  ","  # Redirects to stored location (or to the default).","  def redirect_back_or(default)","      redirect_to(session[:forwarding_url] || default)","      session.delete(:forwarding_url)","  end","  ","  # Stores the URL trying to be accessed.","  def store_location","      session[:forwarding_url] = request.original_url if request.get?","  end","  ","  # Confirms a logged-in user.","  def logged_in_user","    unless logged_in?","      store_location","      flash[:danger] = \"Please log in.\"","      redirect_to login_url","    end","  end","  ","  # Confirms the correct user.","  def correct_user","    # @user = User.find(session[:user_id])","    unless (isAdmin? || isSuperAdmin?)","      if params[:id] == nil","        flash[:danger] = \"You're not valid to perform such operations. Please login as Admin or SuperAdmin to move on.\"","        redirect_to login_url","        return","      end","      @user = User.find(params[:id])","      unless current_user?(@user)","        flash[:danger] = \"You cannot view or edit other user's info.\"","        redirect_to current_user","        return","      end","    end","  end"],"id":126}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":63,"column":5},"end":{"row":63,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1526231850804,"hash":"68da7ef7af464fccfa31c85bbd3b78e665375675"}